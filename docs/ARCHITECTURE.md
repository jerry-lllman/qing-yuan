# Qing-Yuan - å¤šç«¯å³æ—¶é€šè®¯åº”ç”¨æ¶æ„æ–‡æ¡£

> ä¸€æ¬¾æ”¯æŒ iOSã€Androidã€PC çš„å³æ—¶é€šè®¯è½¯ä»¶ï¼Œé‡‡ç”¨ TypeScript å…¨æ ˆå¼€å‘

---

## ç›®å½•

1. [æŠ€æœ¯æ ˆæ¦‚è§ˆ](#1-æŠ€æœ¯æ ˆæ¦‚è§ˆ)
2. [é¡¹ç›®ç»“æ„](#2-é¡¹ç›®ç»“æ„)
3. [æ¶æ„è®¾è®¡](#3-æ¶æ„è®¾è®¡)
4. [åŒ…ä¾èµ–å…³ç³»](#4-åŒ…ä¾èµ–å…³ç³»)
5. [å¼€å‘è®¡åˆ’](#5-å¼€å‘è®¡åˆ’)
6. [æ¨¡å—è¯¦ç»†è¯´æ˜](#6-æ¨¡å—è¯¦ç»†è¯´æ˜)
7. [æ¶ˆæ¯åŒæ­¥ä¸ç¦»çº¿ç­–ç•¥](#7-æ¶ˆæ¯åŒæ­¥ä¸ç¦»çº¿ç­–ç•¥)
8. [API ç‰ˆæœ¬ç®¡ç†](#8-api-ç‰ˆæœ¬ç®¡ç†)
9. [ç›‘æ§ä¸å¯è§‚æµ‹æ€§](#9-ç›‘æ§ä¸å¯è§‚æµ‹æ€§)
10. [å¼€å‘è§„èŒƒ](#10-å¼€å‘è§„èŒƒ)
11. [éƒ¨ç½²æ¶æ„](#11-éƒ¨ç½²æ¶æ„)

---

## 1. æŠ€æœ¯æ ˆæ¦‚è§ˆ

| å±‚çº§         | æŠ€æœ¯é€‰å‹                                 |
| ------------ | ---------------------------------------- |
| **æ¡Œé¢ç«¯**   | Electron + Vite + React                  |
| **ç§»åŠ¨ç«¯**   | React Native (iOS & Android)             |
| **åç«¯**     | Nest.js + Prisma + PostgreSQL            |
| **å®æ—¶é€šä¿¡** | Socket.io (WebSocket)                    |
| **çŠ¶æ€ç®¡ç†** | Zustand + TanStack Query                 |
| **æ„å»ºå·¥å…·** | pnpm + Turborepo                         |
| **ç±»å‹éªŒè¯** | Zod                                      |
| **æ ·å¼æ–¹æ¡ˆ** | Tailwind CSS (Web) / StyleSheet (Native) |
| **ç»„ä»¶åº“**   | shadcn/ui (Web) / Gluestack UI (Native)  |

---

## 2. é¡¹ç›®ç»“æ„

```
qing-yuan/
â”œâ”€â”€ apps/                               # ğŸš€ åº”ç”¨å±‚ï¼ˆå¯ç‹¬ç«‹éƒ¨ç½²çš„åº”ç”¨ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ desktop/                        # ğŸ’» Electron æ¡Œé¢åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ main/                   # Electron ä¸»è¿›ç¨‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts            # ä¸»è¿›ç¨‹å…¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ipc/                # IPC é€šä¿¡å¤„ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tray/               # ç³»ç»Ÿæ‰˜ç›˜
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ updater/            # è‡ªåŠ¨æ›´æ–°
â”‚   â”‚   â”‚   â”œâ”€â”€ preload/                # é¢„åŠ è½½è„šæœ¬ï¼ˆå®‰å…¨æ¡¥æ¥ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ renderer/               # Electron æ¸²æŸ“è¿›ç¨‹
â”‚   â”‚   â”‚       â”œâ”€â”€ App.tsx             # å¼•å…¥ ui-web + client-state
â”‚   â”‚   â”‚       â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚       â””â”€â”€ router/             # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ resources/                  # åº”ç”¨èµ„æºï¼ˆå›¾æ ‡ç­‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ electron.vite.config.ts
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â”œâ”€â”€ mobile/                         # ğŸ“± React Native ç§»åŠ¨åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx                 # å¼•å…¥ ui-native + client-state
â”‚   â”‚   â”‚   â”œâ”€â”€ screens/                # å±å¹•ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ navigation/             # React Navigation é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ native-modules/         # åŸç”Ÿæ¨¡å—æ¡¥æ¥
â”‚   â”‚   â”‚   â””â”€â”€ services/               # ç§»åŠ¨ç«¯ç‰¹æœ‰æœåŠ¡
â”‚   â”‚   â”‚       â”œâ”€â”€ push/               # æ¨é€é€šçŸ¥å¤„ç†
â”‚   â”‚   â”‚       â”œâ”€â”€ background/         # åå°ä»»åŠ¡
â”‚   â”‚   â”‚       â””â”€â”€ biometrics/         # ç”Ÿç‰©è¯†åˆ«è®¤è¯
â”‚   â”‚   â”œâ”€â”€ ios/                        # iOS åŸç”Ÿä»£ç 
â”‚   â”‚   â”œâ”€â”€ android/                    # Android åŸç”Ÿä»£ç 
â”‚   â”‚   â”œâ”€â”€ metro.config.js             # Metro æ‰“åŒ…é…ç½®
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ server/                         # ğŸ”§ Nest.js åç«¯æœåŠ¡
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ main.ts                 # æœåŠ¡å…¥å£
â”‚       â”‚   â”œâ”€â”€ app.module.ts
â”‚       â”‚   â”œâ”€â”€ modules/
â”‚       â”‚   â”‚   â”œâ”€â”€ auth/               # è®¤è¯æ¨¡å— (JWT, OAuth)
â”‚       â”‚   â”‚   â”œâ”€â”€ user/               # ç”¨æˆ·æ¨¡å—
â”‚       â”‚   â”‚   â”œâ”€â”€ friend/             # å¥½å‹å…³ç³»
â”‚       â”‚   â”‚   â”œâ”€â”€ chat/               # ç§èŠ
â”‚       â”‚   â”‚   â”œâ”€â”€ group/              # ç¾¤èŠ
â”‚       â”‚   â”‚   â”œâ”€â”€ message/            # æ¶ˆæ¯å­˜å‚¨/æ£€ç´¢
â”‚       â”‚   â”‚   â”œâ”€â”€ file/               # æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½
â”‚       â”‚   â”‚   â””â”€â”€ notification/       # æ¨é€é€šçŸ¥ (FCM/APNs)
â”‚       â”‚   â”œâ”€â”€ gateway/                # WebSocket ç½‘å…³
â”‚       â”‚   â”‚   â”œâ”€â”€ chat.gateway.ts     # èŠå¤© WS ç½‘å…³
â”‚       â”‚   â”‚   â””â”€â”€ notification.gateway.ts
â”‚       â”‚   â”œâ”€â”€ common/
â”‚       â”‚   â”‚   â”œâ”€â”€ guards/             # å®ˆå«
â”‚       â”‚   â”‚   â”œâ”€â”€ interceptors/       # æ‹¦æˆªå™¨
â”‚       â”‚   â”‚   â”œâ”€â”€ filters/            # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚       â”‚   â”‚   â””â”€â”€ decorators/         # è‡ªå®šä¹‰è£…é¥°å™¨
â”‚       â”‚   â””â”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚       â”œâ”€â”€ prisma/                     # Prisma ORM
â”‚       â”‚   â””â”€â”€ schema.prisma
â”‚       â”œâ”€â”€ nest-cli.json
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ packages/                           # ğŸ“¦ åº“å±‚ï¼ˆå¯å¤ç”¨çš„ä»£ç åŒ…ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/                         # ğŸ§  çº¯ TS é€»è¾‘ï¼ˆé›¶æ¡†æ¶ä¾èµ–ï¼‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ types/                  # ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ message.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ chat.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ constants/              # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ errors.ts           # é”™è¯¯ç 
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ limits.ts           # ä¸šåŠ¡é™åˆ¶å¸¸é‡
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ date.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ format.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ validator.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json                # é›¶ä¾èµ–
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ protocol/                       # ğŸ“¡ é€šä¿¡åè®®ï¼ˆå‰åç«¯å…±äº«ï¼‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ events/                 # WebSocket äº‹ä»¶å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ message.events.ts   # æ¶ˆæ¯ç›¸å…³äº‹ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ chat.events.ts      # ä¼šè¯ç›¸å…³äº‹ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.events.ts      # ç”¨æˆ·çŠ¶æ€äº‹ä»¶
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ payloads/               # äº‹ä»¶è½½è·ç±»å‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ message.payload.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ chat.payload.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ schemas/                # Zod éªŒè¯ schema
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.schema.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ message.schema.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ user.schema.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json                # ä¾èµ–: zod
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ client-core/                    # ğŸ”Œ å®¢æˆ·ç«¯æ ¸å¿ƒï¼ˆç½‘ç»œ + å­˜å‚¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ api/                    # HTTP API å°è£…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts           # Axios å®ä¾‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.api.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.api.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ chat.api.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ socket/                 # WebSocket å°è£…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ socket-client.ts    # Socket.io å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ event-handlers.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ storage/                # æœ¬åœ°å­˜å‚¨æŠ½è±¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ adapter.ts          # å­˜å‚¨é€‚é…å™¨æ¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ web-adapter.ts      # IndexedDB å®ç°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ native-adapter.ts   # MMKV/AsyncStorage å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ sync/                   # æ•°æ®åŒæ­¥
â”‚   â”‚   â”‚       â”œâ”€â”€ message-sync.ts     # æ¶ˆæ¯åŒæ­¥ç­–ç•¥
â”‚   â”‚   â”‚       â””â”€â”€ offline-queue.ts    # ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ package.json                # ä¾èµ–: shared, protocol, axios, socket.io-client
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ client-state/                   # ğŸª å‰ç«¯çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ stores/                 # Zustand Stores
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.store.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.store.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ chat.store.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ message.store.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ui.store.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/                  # ä¸šåŠ¡ Hooks
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useChat.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useMessages.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ useSocket.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ queries/                # TanStack Query
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.queries.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ chat.queries.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json                # ä¾èµ–: shared, client-core, zustand, @tanstack/react-query
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ encryption/                     # ğŸ” ç«¯åˆ°ç«¯åŠ å¯†
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ signal/                 # Signal Protocol å®ç°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ keys.ts             # å¯†é’¥ç”Ÿæˆä¸ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ session.ts          # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ratchet.ts          # Double Ratchet ç®—æ³•
â”‚   â”‚   â”‚   â”œâ”€â”€ crypto/                 # åŠ å¯†åŸè¯­
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ aes.ts              # AES åŠ å¯†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ curve.ts            # Curve25519
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ hash.ts             # å“ˆå¸Œå‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json                # ä¾èµ–: shared, protocol, @aspect-build/libsignal-client
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ ui-web/                         # ğŸ–¥ï¸ Web/Electron UI ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base/               # åŸºç¡€ç»„ä»¶ (shadcn/ui)
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Input/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Avatar/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Modal/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ chat/               # èŠå¤©ç»„ä»¶ï¼ˆè‡ªå®šä¹‰å®ç°ï¼‰
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatBubble/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatInput/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatList/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ MessageList/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ layout/             # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ Sidebar/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ Header/
â”‚   â”‚   â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tokens.css          # è®¾è®¡ä»¤ç‰Œ
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ global.css
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ components.json             # shadcn/ui é…ç½®
â”‚   â”‚   â”œâ”€â”€ package.json                # ä¾èµ–: shared, react, tailwindcss, @radix-ui/*
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ ui-native/                      # ğŸ“± React Native UI ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                 # Gluestack UI v3 ç»„ä»¶ (copy-paste)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ chat/               # èŠå¤©ç»„ä»¶ï¼ˆè‡ªå®šä¹‰å®ç°ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ theme/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ tokens.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json                # ä¾èµ–: shared, react-native, nativewind
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ testing/                        # ğŸ§ª æµ‹è¯•å·¥å…·åŒ…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ factories/              # æ•°æ®å·¥å‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.factory.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ message.factory.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ chat.factory.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ mocks/                  # Mock å®ç°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ socket.mock.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ storage.mock.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ api.mock.ts
â”‚   â”‚   â”‚   â””â”€â”€ helpers/                # æµ‹è¯•è¾…åŠ©å‡½æ•°
â”‚   â”‚   â”‚       â””â”€â”€ test-utils.ts
â”‚   â”‚   â”œâ”€â”€ package.json                # ä¾èµ–: vitest, @testing-library/*
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ typescript-config/              # ğŸ“ å…±äº« TypeScript é…ç½®
â”‚   â”‚   â”œâ”€â”€ base.json
â”‚   â”‚   â”œâ”€â”€ react.json
â”‚   â”‚   â”œâ”€â”€ react-native.json
â”‚   â”‚   â”œâ”€â”€ node.json
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â”œâ”€â”€ eslint-config/                  # ğŸ“ å…±äº« ESLint é…ç½®
â”‚   â”‚   â”œâ”€â”€ base.js
â”‚   â”‚   â”œâ”€â”€ react.js
â”‚   â”‚   â”œâ”€â”€ node.js
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ prettier-config/                # ğŸ¨ å…±äº« Prettier é…ç½®
â”‚       â”œâ”€â”€ index.js
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ .github/                            # GitHub é…ç½®
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml                      # CI æµç¨‹
â”‚       â”œâ”€â”€ release-desktop.yml         # æ¡Œé¢ç«¯å‘å¸ƒ
â”‚       â”œâ”€â”€ release-mobile.yml          # ç§»åŠ¨ç«¯å‘å¸ƒ
â”‚       â””â”€â”€ release-server.yml          # æœåŠ¡ç«¯å‘å¸ƒ
â”‚
â”œâ”€â”€ turbo.json                          # Turborepo é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml                 # pnpm workspace é…ç½®
â”œâ”€â”€ package.json                        # æ ¹ package.json
â”œâ”€â”€ tsconfig.json                       # æ ¹ TS é…ç½®
â”œâ”€â”€ .env.example                        # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ README.md
```

---

## 3. æ¶æ„è®¾è®¡

### 3.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              å®¢æˆ·ç«¯å±‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Desktop App   â”‚   Mobile App    â”‚                                     â”‚
â”‚   (Electron)    â”‚ (React Native)  â”‚                                     â”‚
â”‚        â”‚        â”‚        â”‚        â”‚                                     â”‚
â”‚   ui-web â—„â”€â”€â”€â”€â”€â”€â”¼â”€â”€ ui-native     â”‚                                     â”‚
â”‚  (shadcn/ui)    â”‚  (Gluestack)    â”‚                                     â”‚
â”‚        â”‚        â”‚        â”‚        â”‚                                     â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚                                     â”‚
â”‚                 â”‚                 â”‚                                     â”‚
â”‚          client-state             â”‚    Zustand + TanStack Query         â”‚
â”‚                 â”‚                 â”‚                                     â”‚
â”‚          client-core              â”‚    API + Socket + Storage           â”‚
â”‚                 â”‚                 â”‚                                     â”‚
â”‚           encryption              â”‚    E2E åŠ å¯†                          â”‚
â”‚                 â”‚                 â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           protocol (å…±äº«åè®®)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           shared (å…±äº«ç±»å‹/å·¥å…·)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                         HTTP REST + WebSocket
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              æœåŠ¡ç«¯å±‚                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          Nest.js Server                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        Gateway Layer                              â”‚  â”‚
â”‚  â”‚   chat.gateway.ts    notification.gateway.ts                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        Module Layer                               â”‚  â”‚
â”‚  â”‚   auth â”‚ user â”‚ friend â”‚ chat â”‚ group â”‚ message â”‚ file â”‚ notif   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        Common Layer                               â”‚  â”‚
â”‚  â”‚   guards â”‚ interceptors â”‚ filters â”‚ decorators â”‚ config          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                              Prisma ORM
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              æ•°æ®å±‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    PostgreSQL    â”‚      Redis       â”‚         Object Storage            â”‚
â”‚    (ä¸»æ•°æ®åº“)     â”‚    (ç¼“å­˜/ä¼šè¯)    â”‚      (æ–‡ä»¶/å›¾ç‰‡/è§†é¢‘)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ¶ˆæ¯æµè½¬æ¶æ„

```
å‘é€æ¶ˆæ¯æµç¨‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â”€â–¶â”‚ Encrypt  â”‚â”€â”€â”€â”€â–¶â”‚  Socket  â”‚â”€â”€â”€â”€â–¶â”‚  Server  â”‚
â”‚   Input  â”‚     â”‚  (E2E)   â”‚     â”‚   Send   â”‚     â”‚ Gateway  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
                                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â—€â”€â”€â”€â”€â”‚ Decrypt  â”‚â—€â”€â”€â”€â”€â”‚  Socket  â”‚â—€â”€â”€â”€â”€â”‚ Broadcastâ”‚
â”‚   Show   â”‚     â”‚  (E2E)   â”‚     â”‚ Receive  â”‚     â”‚ to Users â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¦»çº¿æ¶ˆæ¯æµç¨‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â”€â–¶â”‚  Offline â”‚â”€â”€â”€â”€â–¶â”‚  Server  â”‚
â”‚  Online  â”‚     â”‚   Sync   â”‚     â”‚   Pull   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Local Storageâ”‚
              â”‚    Update    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 å®¢æˆ·ç«¯çŠ¶æ€æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UI Layer                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚  ChatList   â”‚  â”‚ MessageList â”‚  â”‚   Sidebar   â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                â”‚
           â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Hooks Layer                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚   useChat   â”‚  â”‚ useMessages â”‚  â”‚   useAuth   â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                â”‚
           â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      State Layer                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    Zustand Stores                        â”‚  â”‚
â”‚   â”‚  auth.store â”‚ chat.store â”‚ message.store â”‚ ui.store      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                   TanStack Query                         â”‚  â”‚
â”‚   â”‚  user.queries â”‚ chat.queries â”‚ message.queries           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                â”‚                â”‚
           â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Core Layer                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚  API Client â”‚  â”‚   Socket    â”‚  â”‚   Storage   â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. åŒ…ä¾èµ–å…³ç³»

```
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚     shared      â”‚  (é›¶ä¾èµ–)
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                   â”‚                   â”‚
              â–¼                   â–¼                   â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ protocol  â”‚        â”‚  testing  â”‚       â”‚           â”‚
      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚           â”‚
              â”‚                                 â”‚           â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
              â”‚                                 â”‚           â”‚
              â–¼                                 â–¼           â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
      â”‚ encryption  â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚    â”‚
      â”‚ (Signal)    â”‚                   â”‚             â”‚    â”‚
      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚             â”‚    â”‚
              â”‚                          â”‚             â”‚    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
                             â”‚                          â”‚    â”‚
                             â–¼                          â”‚    â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚    â”‚
                      â”‚ client-core â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                       â”‚
                             â”‚                               â”‚
                             â–¼                               â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
                      â”‚client-state â”‚                       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                       â”‚
                             â”‚                               â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
               â”‚                           â”‚                â”‚
               â–¼                           â–¼                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
        â”‚   ui-web    â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  ui-native  â”‚ â—€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ (shadcn/ui) â”‚   shared    â”‚ (Gluestack) â”‚   shared
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
               â”‚                           â”‚
               â–¼                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   desktop   â”‚             â”‚   mobile    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœåŠ¡ç«¯åˆ†æ”¯:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     server      â”‚ â”€â”€â”€â”€â”€â”€â–¶ shared + protocol + encryption (ä»…å¯†é’¥äº¤æ¢ç›¸å…³ç±»å‹)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¾èµ–å…³ç³»è¯´æ˜

| åŒ…å           | ä¾èµ–                         | è¯´æ˜                                           |
| -------------- | ---------------------------- | ---------------------------------------------- |
| `shared`       | æ—                            | é›¶ä¾èµ–ï¼Œçº¯ç±»å‹å’Œå·¥å…·å‡½æ•°                       |
| `protocol`     | shared, zod                  | é€šä¿¡åè®®å®šä¹‰ï¼ŒåŒ…å«åŠ å¯†æ¶ˆæ¯ç±»å‹                 |
| `encryption`   | shared, protocol             | ç«¯åˆ°ç«¯åŠ å¯†å®ç°ï¼Œéœ€è¦ protocol ä¸­çš„åŠ å¯†æ¶ˆæ¯ç±»å‹ |
| `client-core`  | shared, protocol, encryption | å®¢æˆ·ç«¯æ ¸å¿ƒï¼Œç½‘ç»œå’Œå­˜å‚¨                         |
| `client-state` | shared, client-core          | çŠ¶æ€ç®¡ç†å±‚                                     |
| `ui-web`       | shared, client-state         | Web UI ç»„ä»¶ï¼Œéœ€è¦ shared ä¸­çš„ç±»å‹å®šä¹‰          |
| `ui-native`    | shared, client-state         | Native UI ç»„ä»¶ï¼Œéœ€è¦ shared ä¸­çš„ç±»å‹å®šä¹‰       |
| `server`       | shared, protocol             | æœåŠ¡ç«¯ï¼Œå¤„ç†å¯†é’¥äº¤æ¢ä½†ä¸è§£å¯†æ¶ˆæ¯               |

### ä¾èµ–ç‰ˆæœ¬ç®¡ç†

ä½¿ç”¨ `pnpm-workspace.yaml` é…åˆ `pnpm catalog` ç»Ÿä¸€ç®¡ç†ä¾èµ–ç‰ˆæœ¬ï¼š

```yaml
# pnpm-workspace.yaml
packages:
  - 'apps/*'
  - 'packages/*'

catalog:
  # æ ¸å¿ƒæ¡†æ¶
  react: latest
  react-dom: latest
  react-native: latest
  typescript: latest

  # çŠ¶æ€ç®¡ç†
  zustand: latest
  '@tanstack/react-query': latest

  # æ•°æ®éªŒè¯
  zod: latest

  # ç½‘ç»œé€šä¿¡
  socket.io: latest
  socket.io-client: latest
  axios: latest

  # åç«¯æ¡†æ¶
  '@nestjs/core': latest
  '@nestjs/common': latest
  '@nestjs/platform-socket.io': latest
  '@nestjs/websockets': latest
  prisma: latest
  '@prisma/client': latest

  # UI ç»„ä»¶åº“
  '@radix-ui/react-*': latest
  nativewind: latest # Gluestack UI v3 ä¾èµ–
  tailwindcss: latest

  # Electron
  electron: latest
  electron-vite: latest
  electron-builder: latest

  # åŠ å¯†
  '@aspect-build/libsignal-client': latest

  # æµ‹è¯•
  vitest: latest
  '@testing-library/react': latest
  '@testing-library/react-native': latest
```

> **æ³¨æ„**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ `pnpm update` åé”å®šç‰ˆæœ¬ï¼Œç¡®ä¿æ„å»ºå¯é‡å¤æ€§ã€‚

---

## 5. å¼€å‘è®¡åˆ’

> ğŸ“‹ **å¼€å‘è®¡åˆ’å·²ç‹¬ç«‹æˆæ–‡æ¡£**: [DEVELOPMENT_PLAN.md](./DEVELOPMENT_PLAN.md)
>
> åŒ…å«ï¼š
>
> - å„é˜¶æ®µä»»åŠ¡è¯¦æƒ…ä¸è¿›åº¦è¿½è¸ª
> - å·²å®ŒæˆåŠŸèƒ½æ ‡è®°
> - å¼€å‘æ³¨æ„äº‹é¡¹ä¸æŠ€æœ¯è¦ç‚¹
> - æ›´æ–°æ—¥å¿—

---

## 6. æ¨¡å—è¯¦ç»†è¯´æ˜

### 6.1 packages/protocol

**èŒè´£**ï¼šå®šä¹‰å‰åç«¯å…±äº«çš„ WebSocket äº‹ä»¶å’Œæ•°æ®éªŒè¯ schema

```typescript
// packages/protocol/src/events/message.events.ts
export enum MessageEvent {
  // å®¢æˆ·ç«¯ -> æœåŠ¡ç«¯
  SEND = 'message:send',
  EDIT = 'message:edit',
  DELETE = 'message:delete',
  READ = 'message:read',
  TYPING_START = 'message:typing:start',
  TYPING_STOP = 'message:typing:stop',

  // æœåŠ¡ç«¯ -> å®¢æˆ·ç«¯
  RECEIVE = 'message:receive',
  DELIVERED = 'message:delivered',
  UPDATED = 'message:updated',
  DELETED = 'message:deleted',
  READ_RECEIPT = 'message:read:receipt',
  TYPING = 'message:typing',
}

// packages/protocol/src/schemas/message.schema.ts
import { z } from 'zod';

export const sendMessageSchema = z.object({
  conversationId: z.string().uuid(),
  content: z.string().min(1).max(10000),
  type: z.enum(['text', 'image', 'file', 'voice', 'video']),
  replyTo: z.string().uuid().optional(),
  attachments: z
    .array(
      z.object({
        id: z.string(),
        type: z.string(),
        url: z.string().url(),
        name: z.string(),
        size: z.number(),
      })
    )
    .optional(),
});

export type SendMessagePayload = z.infer<typeof sendMessageSchema>;
```

### 6.2 packages/client-core

**èŒè´£**ï¼šæä¾›è·¨å¹³å°çš„ç½‘ç»œè¯·æ±‚ã€WebSocket è¿æ¥ã€æœ¬åœ°å­˜å‚¨æŠ½è±¡

```typescript
// packages/client-core/src/storage/adapter.ts
export interface StorageAdapter {
  get<T>(key: string): Promise<T | null>;
  set<T>(key: string, value: T): Promise<void>;
  delete(key: string): Promise<void>;
  clear(): Promise<void>;

  // æ‰¹é‡æ“ä½œ
  multiGet<T>(keys: string[]): Promise<Map<string, T>>;
  multiSet<T>(entries: [string, T][]): Promise<void>;
}

// packages/client-core/src/socket/socket-client.ts
export class SocketClient {
  private socket: Socket;
  private reconnectAttempts = 0;

  connect(token: string): Promise<void>;
  disconnect(): void;

  emit<T>(event: string, payload: T): void;
  on<T>(event: string, handler: (payload: T) => void): void;
  off(event: string, handler?: Function): void;

  // è¿æ¥çŠ¶æ€
  get isConnected(): boolean;
  onConnectionChange(handler: (connected: boolean) => void): void;
}
```

### 6.3 packages/client-state

**èŒè´£**ï¼šç»Ÿä¸€ç®¡ç†å®¢æˆ·ç«¯çŠ¶æ€ï¼Œæä¾›ä¸šåŠ¡ Hooks

```typescript
// packages/client-state/src/stores/message.store.ts
import { create } from 'zustand';
import { immer } from 'zustand/middleware/immer';

interface MessageState {
  messages: Map<string, Message[]>; // conversationId -> messages
  pendingMessages: Message[];

  // Actions
  addMessage: (conversationId: string, message: Message) => void;
  updateMessage: (messageId: string, updates: Partial<Message>) => void;
  deleteMessage: (messageId: string) => void;
  markAsRead: (conversationId: string, messageId: string) => void;
}

export const useMessageStore = create<MessageState>()(
  immer((set) => ({
    messages: new Map(),
    pendingMessages: [],

    addMessage: (conversationId, message) =>
      set((state) => {
        const existing = state.messages.get(conversationId) || [];
        state.messages.set(conversationId, [...existing, message]);
      }),

    // ... å…¶ä»– actions
  }))
);

// packages/client-state/src/hooks/useMessages.ts
export function useMessages(conversationId: string) {
  const messages = useMessageStore((state) => state.messages.get(conversationId) || []);
  const addMessage = useMessageStore((state) => state.addMessage);
  const socket = useSocket();

  const sendMessage = useCallback(
    async (content: string) => {
      const message = createOptimisticMessage(content);
      addMessage(conversationId, message);

      socket.emit(MessageEvent.SEND, {
        conversationId,
        content,
        type: 'text',
      });
    },
    [conversationId, addMessage, socket]
  );

  return { messages, sendMessage };
}
```

### 6.4 packages/encryption

**èŒè´£**ï¼šå®ç°ç«¯åˆ°ç«¯åŠ å¯†ï¼Œä¿æŠ¤ç”¨æˆ·éšç§

```typescript
// packages/encryption/src/signal/session.ts
export class SignalSession {
  private identityKeyPair: KeyPair;
  private preKeys: PreKey[];
  private sessions: Map<string, SessionState>;

  // åˆå§‹åŒ–å¯†é’¥
  async initialize(): Promise<void>;

  // å»ºç«‹ä¼šè¯
  async createSession(recipientId: string, preKeyBundle: PreKeyBundle): Promise<void>;

  // åŠ å¯†æ¶ˆæ¯
  async encrypt(recipientId: string, plaintext: string): Promise<EncryptedMessage>;

  // è§£å¯†æ¶ˆæ¯
  async decrypt(senderId: string, ciphertext: EncryptedMessage): Promise<string>;
}
```

### 6.5 packages/ui-web (shadcn/ui)

**èŒè´£**ï¼šWeb/Electron ç«¯ UI ç»„ä»¶åº“

```typescript
// packages/ui-web/tsconfig.json ä¸­é…ç½®è·¯å¾„åˆ«å
// "paths": { "@/*": ["./src/*"] }

// packages/ui-web/src/components/base/Button/Button.tsx
// ä½¿ç”¨ shadcn/ui çš„ Button ç»„ä»¶
import { Button as ShadcnButton } from "@/components/ui/button";
import { cn } from "@/lib/utils";

interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?:
    | "default"
    | "destructive"
    | "outline"
    | "secondary"
    | "ghost"
    | "link";
  size?: "default" | "sm" | "lg" | "icon";
}

export function Button({ className, variant, size, ...props }: ButtonProps) {
  return (
    <ShadcnButton
      className={cn(className)}
      variant={variant}
      size={size}
      {...props}
    />
  );
}

// packages/ui-web/src/components/chat/ChatBubble/ChatBubble.tsx
// èŠå¤©æ°”æ³¡ - è‡ªå®šä¹‰å®ç°
import type { Message } from "@qing-yuan/shared";

interface ChatBubbleProps {
  message: Message;
  isOwn: boolean;
  showAvatar?: boolean;
}

export function ChatBubble({ message, isOwn, showAvatar }: ChatBubbleProps) {
  return (
    <div className={cn("flex gap-2", isOwn && "flex-row-reverse")}>
      {showAvatar && <Avatar src={message.sender.avatar} />}
      <div
        className={cn(
          "max-w-[70%] rounded-2xl px-4 py-2",
          isOwn ? "bg-primary text-primary-foreground" : "bg-muted"
        )}
      >
        <p className="text-sm">{message.content}</p>
        <span className="text-xs opacity-70">
          {formatTime(message.createdAt)}
        </span>
      </div>
    </div>
  );
}
```

### 6.6 packages/ui-native (Gluestack UI)

**èŒè´£**ï¼šReact Native ç«¯ UI ç»„ä»¶åº“

```typescript
// packages/ui-native/src/components/base/Button/Button.tsx
// Gluestack UI v3 é‡‡ç”¨ copy-paste æ¨¡å¼ï¼Œç»„ä»¶ä»æœ¬åœ°å¯¼å…¥
import { Button as GluestackButton, ButtonText } from "@/components/ui/button";
import type { Message } from "@qing-yuan/shared";

interface ButtonProps {
  children: string;
  variant?: "solid" | "outline" | "link";
  size?: "xs" | "sm" | "md" | "lg" | "xl";
  onPress?: () => void;
}

export function Button({
  children,
  variant = "solid",
  size = "md",
  onPress,
}: ButtonProps) {
  return (
    <GluestackButton variant={variant} size={size} onPress={onPress}>
      <ButtonText>{children}</ButtonText>
    </GluestackButton>
  );
}

// packages/ui-native/src/components/chat/ChatBubble/ChatBubble.tsx
import { Box } from "@/components/ui/box";
import { Text } from "@/components/ui/text";
import { HStack } from "@/components/ui/hstack";
import { Avatar } from "@/components/ui/avatar";
import type { Message } from "@qing-yuan/shared";

interface ChatBubbleProps {
  message: Message;
  isOwn: boolean;
  showAvatar?: boolean;
}

export function ChatBubble({ message, isOwn, showAvatar }: ChatBubbleProps) {
  return (
    <HStack space="sm" className={isOwn ? "justify-end" : "justify-start"}>
      {showAvatar && !isOwn && (
        <Avatar source={{ uri: message.sender.avatar }} />
      )}
      <Box
        className={`max-w-[70%] rounded-2xl px-4 py-2 ${
          isOwn ? "bg-primary-500" : "bg-background-200"
        }`}
      >
        <Text className={isOwn ? "text-white" : "text-typography-900"}>
          {message.content}
        </Text>
        <Text size="xs" className="opacity-70">
          {formatTime(message.createdAt)}
        </Text>
      </Box>
    </HStack>
  );
}
```

### 6.7 apps/server

**èŒè´£**ï¼šæä¾› REST API å’Œ WebSocket å®æ—¶é€šä¿¡

```typescript
// apps/server/src/gateway/chat.gateway.ts
@WebSocketGateway({
  namespace: 'chat',
  cors: { origin: '*', credentials: true },
})
export class ChatGateway implements OnGatewayConnection, OnGatewayDisconnect {
  @WebSocketServer()
  server: Namespace;

  constructor(
    private messageService: MessageService,
    private userService: UserService
  ) {}

  async handleConnection(client: Socket) {
    const userId = await this.validateToken(client);
    if (!userId) {
      client.disconnect();
      return;
    }

    // åŠ å…¥ç”¨æˆ·æˆ¿é—´ï¼Œæ”¯æŒå¤šè®¾å¤‡
    client.join(`user:${userId}`);
    await this.userService.setOnline(userId);
  }

  @SubscribeMessage(MessageEvent.SEND)
  @UseGuards(WsAuthGuard)
  async handleSendMessage(
    @MessageBody() payload: SendMessagePayload,
    @ConnectedSocket() client: Socket
  ) {
    // éªŒè¯ payload
    const validated = sendMessageSchema.parse(payload);

    // ä¿å­˜æ¶ˆæ¯
    const message = await this.messageService.create(validated);

    // å¹¿æ’­ç»™ä¼šè¯æˆå‘˜
    const recipientIds = await this.getConversationMembers(validated.conversationId);
    for (const recipientId of recipientIds) {
      this.server.to(`user:${recipientId}`).emit(MessageEvent.RECEIVE, message);
    }

    return { success: true, messageId: message.id };
  }
}
```

---

## 7. æ¶ˆæ¯åŒæ­¥ä¸ç¦»çº¿ç­–ç•¥

### 7.1 æ¶ˆæ¯åŒæ­¥æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ¶ˆæ¯åŒæ­¥ç­–ç•¥                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  å®æ—¶æ¨é€    â”‚    â”‚  å¢é‡åŒæ­¥    â”‚    â”‚  å…¨é‡åŒæ­¥    â”‚         â”‚
â”‚  â”‚  (WebSocket) â”‚    â”‚  (Cursor)   â”‚    â”‚  (é¦–æ¬¡ç™»å½•)  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                  â”‚                  â”‚                â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                            â”‚                                    â”‚
â”‚                            â–¼                                    â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                   â”‚   æœ¬åœ°å­˜å‚¨       â”‚                          â”‚
â”‚                   â”‚  (IndexedDB/    â”‚                          â”‚
â”‚                   â”‚   MMKV)         â”‚                          â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 åŒæ­¥ç­–ç•¥è¯¦è§£

#### å¢é‡åŒæ­¥

```typescript
// packages/client-core/src/sync/message-sync.ts
interface SyncCursor {
  conversationId: string;
  lastMessageId: string;
  lastSyncTime: number;
}

export class MessageSyncManager {
  // å¢é‡åŒæ­¥ï¼šåŸºäºæ¸¸æ ‡è·å–æ–°æ¶ˆæ¯
  async syncIncremental(cursor: SyncCursor): Promise<Message[]> {
    const response = await this.api.get('/messages/sync', {
      params: {
        conversationId: cursor.conversationId,
        after: cursor.lastMessageId,
        limit: 100,
      },
    });

    // æ›´æ–°æœ¬åœ°æ¸¸æ ‡
    await this.storage.set(`cursor:${cursor.conversationId}`, {
      lastMessageId: response.messages.at(-1)?.id,
      lastSyncTime: Date.now(),
    });

    return response.messages;
  }

  // åˆ†é¡µåŠ è½½å†å²æ¶ˆæ¯
  async loadHistory(conversationId: string, before: string): Promise<Message[]> {
    return this.api.get('/messages/history', {
      params: { conversationId, before, limit: 50 },
    });
  }
}
```

#### ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—

```typescript
// packages/client-core/src/sync/offline-queue.ts
interface PendingMessage {
  id: string;
  payload: SendMessagePayload;
  createdAt: number;
  retryCount: number;
}

export class OfflineQueue {
  private queue: PendingMessage[] = [];

  // æ·»åŠ åˆ°ç¦»çº¿é˜Ÿåˆ—
  async enqueue(payload: SendMessagePayload): Promise<string> {
    const pending: PendingMessage = {
      id: generateUUID(),
      payload,
      createdAt: Date.now(),
      retryCount: 0,
    };

    this.queue.push(pending);
    await this.storage.set('offline_queue', this.queue);

    return pending.id;
  }

  // ç½‘ç»œæ¢å¤æ—¶æ‰¹é‡å‘é€
  async flush(): Promise<void> {
    const pending = [...this.queue];

    for (const message of pending) {
      try {
        await this.socket.emit(MessageEvent.SEND, message.payload);
        this.queue = this.queue.filter((m) => m.id !== message.id);
      } catch (error) {
        message.retryCount++;
        if (message.retryCount >= 3) {
          // æ ‡è®°ä¸ºå‘é€å¤±è´¥
          this.onMessageFailed(message);
        }
      }
    }

    await this.storage.set('offline_queue', this.queue);
  }
}
```

### 7.3 å¤šè®¾å¤‡æ¶ˆæ¯åŒæ­¥

```typescript
// å¤šè®¾å¤‡åŒæ­¥ç­–ç•¥
interface DeviceSyncState {
  deviceId: string;
  lastSeenMessageId: Map<string, string>; // conversationId -> messageId
}

// æœåŠ¡ç«¯å¤„ç†å¤šè®¾å¤‡
@SubscribeMessage(MessageEvent.SYNC_REQUEST)
async handleSyncRequest(
  @MessageBody() payload: { deviceId: string; cursors: SyncCursor[] }
) {
  // å‘ç”¨æˆ·çš„æ‰€æœ‰è®¾å¤‡å¹¿æ’­ï¼ˆé™¤äº†å‘é€æ–¹ï¼‰
  this.server.to(`user:${userId}`).except(payload.deviceId).emit(
    MessageEvent.SYNC_RESPONSE,
    { messages, cursors: updatedCursors }
  );
}
```

---

## 8. API ç‰ˆæœ¬ç®¡ç†

### 8.1 ç‰ˆæœ¬ç­–ç•¥

| ç±»å‹       | ç­–ç•¥         | ç¤ºä¾‹                                 |
| ---------- | ------------ | ------------------------------------ |
| REST API   | URL ç‰ˆæœ¬å‰ç¼€ | `/api/v1/users`, `/api/v2/users`     |
| WebSocket  | äº‹ä»¶å‘½åç©ºé—´ | `v1:message:send`, `v2:message:send` |
| å®¢æˆ·ç«¯ç‰ˆæœ¬ | è¯·æ±‚å¤´       | `X-Client-Version: 1.2.0`            |

### 8.2 REST API ç‰ˆæœ¬æ§åˆ¶

```typescript
// apps/server/src/main.ts
import { VersioningType } from '@nestjs/common';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);

  // å¯ç”¨ URI ç‰ˆæœ¬æ§åˆ¶
  app.enableVersioning({
    type: VersioningType.URI,
    defaultVersion: '1',
  });

  await app.listen(3000);
}

// apps/server/src/modules/user/user.controller.ts
@Controller('users')
export class UserController {
  @Get()
  @Version('1')
  findAllV1() {
    // v1 å®ç°
  }

  @Get()
  @Version('2')
  findAllV2() {
    // v2 å®ç°ï¼ŒåŒ…å«æ–°å­—æ®µ
  }
}
```

### 8.3 WebSocket äº‹ä»¶ç‰ˆæœ¬æ§åˆ¶

```typescript
// packages/protocol/src/events/message.events.ts
export const MessageEvent = {
  // V1 äº‹ä»¶ï¼ˆä¿æŒå…¼å®¹ï¼‰
  SEND: 'v1:message:send',
  RECEIVE: 'v1:message:receive',

  // V2 äº‹ä»¶ï¼ˆæ–°åŠŸèƒ½ï¼‰
  SEND_V2: 'v2:message:send',      // æ”¯æŒå¯Œæ–‡æœ¬
  RECEIVE_V2: 'v2:message:receive',
} as const;

// æœåŠ¡ç«¯åŒæ—¶æ”¯æŒå¤šç‰ˆæœ¬
@SubscribeMessage(MessageEvent.SEND)
handleSendV1(payload: SendMessagePayloadV1) { /* ... */ }

@SubscribeMessage(MessageEvent.SEND_V2)
handleSendV2(payload: SendMessagePayloadV2) { /* ... */ }
```

### 8.4 å®¢æˆ·ç«¯ç‰ˆæœ¬åå•†

```typescript
// packages/client-core/src/api/client.ts
const apiClient = axios.create({
  baseURL: process.env.API_URL,
  headers: {
    'X-Client-Version': APP_VERSION,
    'X-Client-Platform': PLATFORM, // 'ios' | 'android' | 'desktop'
  },
});

// æœåŠ¡ç«¯æ ¹æ®ç‰ˆæœ¬è¿”å›å…¼å®¹å“åº”
@Injectable()
export class VersionInterceptor implements NestInterceptor {
  intercept(context: ExecutionContext, next: CallHandler) {
    const request = context.switchToHttp().getRequest();
    const clientVersion = request.headers['x-client-version'];

    return next.handle().pipe(map((data) => this.transformForVersion(data, clientVersion)));
  }
}
```

---

## 9. ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### 9.1 ç›‘æ§æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç›‘æ§å¹³å°                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Prometheus   â”‚     Grafana     â”‚      Sentry/Datadog         â”‚
â”‚    (Metrics)    â”‚   (Dashboard)   â”‚    (Error Tracking)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                   â”‚
         â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Server Apps   â”‚                 â”‚  Client Apps    â”‚
â”‚  - API Metrics  â”‚                 â”‚  - Error Report â”‚
â”‚  - WS Metrics   â”‚                 â”‚  - Performance  â”‚
â”‚  - DB Metrics   â”‚                 â”‚  - User Events  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 æœåŠ¡ç«¯ç›‘æ§

```typescript
// apps/server/src/common/interceptors/metrics.interceptor.ts
import { Counter, Histogram } from 'prom-client';

const httpRequestDuration = new Histogram({
  name: 'http_request_duration_seconds',
  help: 'Duration of HTTP requests in seconds',
  labelNames: ['method', 'route', 'status'],
});

const wsConnectionsGauge = new Gauge({
  name: 'ws_connections_total',
  help: 'Total WebSocket connections',
});

const messagesSentCounter = new Counter({
  name: 'messages_sent_total',
  help: 'Total messages sent',
  labelNames: ['type'],
});

@Injectable()
export class MetricsInterceptor implements NestInterceptor {
  intercept(context: ExecutionContext, next: CallHandler) {
    const start = Date.now();
    const request = context.switchToHttp().getRequest();

    return next.handle().pipe(
      tap(() => {
        const duration = (Date.now() - start) / 1000;
        httpRequestDuration.labels(request.method, request.route.path, '200').observe(duration);
      })
    );
  }
}
```

### 9.3 å®¢æˆ·ç«¯é”™è¯¯ä¸ŠæŠ¥

```typescript
// packages/client-core/src/monitoring/error-reporter.ts
import * as Sentry from '@sentry/react-native'; // æˆ– @sentry/electron

export class ErrorReporter {
  static init(config: { dsn: string; environment: string }) {
    Sentry.init({
      dsn: config.dsn,
      environment: config.environment,
      tracesSampleRate: 0.1,
      beforeSend(event) {
        // è¿‡æ»¤æ•æ„Ÿä¿¡æ¯
        return sanitizeEvent(event);
      },
    });
  }

  static captureException(error: Error, context?: Record<string, any>) {
    Sentry.withScope((scope) => {
      if (context) {
        scope.setExtras(context);
      }
      Sentry.captureException(error);
    });
  }

  static setUser(user: { id: string; username: string }) {
    Sentry.setUser({ id: user.id, username: user.username });
  }
}
```

### 9.4 æ€§èƒ½ç›‘æ§

```typescript
// packages/client-core/src/monitoring/performance.ts
export class PerformanceMonitor {
  // æ¶ˆæ¯å‘é€å»¶è¿Ÿ
  static measureMessageLatency(messageId: string) {
    const start = performance.now();

    return {
      end: () => {
        const latency = performance.now() - start;
        this.report('message_latency', latency, { messageId });
      },
    };
  }

  // å¯åŠ¨æ—¶é—´
  static measureAppStartup() {
    const metrics = {
      cold_start: performance.now(),
      first_render: 0,
      interactive: 0,
    };

    return {
      markFirstRender: () => {
        metrics.first_render = performance.now();
      },
      markInteractive: () => {
        metrics.interactive = performance.now();
        this.report('app_startup', metrics);
      },
    };
  }

  private static report(name: string, value: any, tags?: Record<string, string>) {
    // å‘é€åˆ°åˆ†ææœåŠ¡
  }
}
```

---

## 10. å¼€å‘è§„èŒƒ

### 10.1 ä»£ç è§„èŒƒ

- **å‘½åçº¦å®š**
  - æ–‡ä»¶ï¼š`kebab-case.ts` (å¦‚ `message-sync.ts`)
  - ç»„ä»¶ï¼š`PascalCase.tsx` (å¦‚ `ChatBubble.tsx`)
  - ç±»å‹ï¼š`PascalCase` (å¦‚ `MessagePayload`)
  - å¸¸é‡ï¼š`SCREAMING_SNAKE_CASE` (å¦‚ `MAX_MESSAGE_LENGTH`)

- **ç›®å½•ç»“æ„**
  ```
  ComponentName/
  â”œâ”€â”€ index.ts              # å¯¼å‡º
  â”œâ”€â”€ ComponentName.tsx     # ç»„ä»¶å®ç°
  â”œâ”€â”€ ComponentName.test.tsx
  â”œâ”€â”€ ComponentName.styles.ts  # æˆ– .css
  â””â”€â”€ types.ts              # ç»„ä»¶ç±»å‹
  ```

### 10.2 Git è§„èŒƒ

- **åˆ†æ”¯å‘½å**
  - `feature/xxx` - æ–°åŠŸèƒ½
  - `fix/xxx` - Bug ä¿®å¤
  - `refactor/xxx` - é‡æ„
  - `docs/xxx` - æ–‡æ¡£

- **Commit æ ¼å¼**

  ```
  <type>(<scope>): <subject>

  <body>

  <footer>
  ```

  ç±»å‹: `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`

### 10.3 æµ‹è¯•è§„èŒƒ

- **è¦†ç›–ç‡è¦æ±‚**
  - `packages/*`: 80%+
  - `apps/server`: 70%+
  - `apps/desktop`, `apps/mobile`: 60%+

- **æµ‹è¯•æ–‡ä»¶å‘½å**
  - å•å…ƒæµ‹è¯•: `*.test.ts`
  - é›†æˆæµ‹è¯•: `*.integration.test.ts`
  - E2E æµ‹è¯•: `*.e2e.test.ts`

---

## 11. éƒ¨ç½²æ¶æ„

### 11.1 æœåŠ¡ç«¯éƒ¨ç½²

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   CDN (é™æ€èµ„æº)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Load Balancer  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚                   â”‚
         â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Server 1   â”‚ â”‚  API Server 2   â”‚ â”‚  API Server N   â”‚
â”‚   (Nest.js)     â”‚ â”‚   (Nest.js)     â”‚ â”‚   (Nest.js)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                   â”‚                   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚              â”‚              â”‚
              â–¼              â–¼              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ PostgreSQL  â”‚ â”‚    Redis    â”‚ â”‚     S3      â”‚
      â”‚  (Primary)  â”‚ â”‚  (Cluster)  â”‚ â”‚  (Storage)  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ PostgreSQL  â”‚
      â”‚  (Replica)  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 11.2 å®¢æˆ·ç«¯å‘å¸ƒ

| å¹³å°    | å‘å¸ƒæ¸ é“               | è‡ªåŠ¨æ›´æ–°             |
| ------- | ---------------------- | -------------------- |
| Windows | GitHub Releases / å®˜ç½‘ | electron-updater     |
| macOS   | GitHub Releases / å®˜ç½‘ | electron-updater     |
| iOS     | App Store              | App Store            |
| Android | Google Play / APK      | Google Play / In-app |

### 11.3 ç¯å¢ƒé…ç½®

```bash
# .env.example

# Server
NODE_ENV=development
PORT=3000
DATABASE_URL=postgresql://user:pass@localhost:5432/qing-yuan
REDIS_URL=redis://localhost:6379

# JWT
JWT_SECRET=your-secret-key
JWT_ACCESS_EXPIRES=15m
JWT_REFRESH_EXPIRES=7d

# Push Notifications
FCM_SERVER_KEY=your-fcm-key
APNS_KEY_ID=your-apns-key-id
APNS_TEAM_ID=your-team-id

# Storage
S3_BUCKET=qing-yuan-uploads
S3_REGION=ap-northeast-1
S3_ACCESS_KEY=your-access-key
S3_SECRET_KEY=your-secret-key

# Monitoring
SENTRY_DSN=your-sentry-dsn
PROMETHEUS_PORT=9090
```

---

## é™„å½•

### A. æŠ€æœ¯é€‰å‹ç†ç”±

| æŠ€æœ¯                | é€‰å‹ç†ç”±                                                       |
| ------------------- | -------------------------------------------------------------- |
| **pnpm**            | æ›´å¿«çš„å®‰è£…é€Ÿåº¦ï¼Œä¸¥æ ¼çš„ä¾èµ–ç®¡ç†ï¼Œå¤©ç„¶æ”¯æŒ monorepo              |
| **Turborepo**       | å¢é‡æ„å»ºï¼Œè¿œç¨‹ç¼“å­˜ï¼Œä»»åŠ¡ç¼–æ’                                   |
| **Zustand**         | è½»é‡ã€ç®€å•ã€TypeScript å‹å¥½ï¼Œé€‚åˆä¸­å‹åº”ç”¨                      |
| **TanStack Query**  | å¼ºå¤§çš„æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†ï¼Œè‡ªåŠ¨ç¼“å­˜å’Œé‡è¯•                           |
| **Zod**             | è¿è¡Œæ—¶ç±»å‹éªŒè¯ï¼Œä¸ TypeScript æ— ç¼é›†æˆ                         |
| **Prisma**          | ç±»å‹å®‰å…¨çš„ ORMï¼Œä¼˜ç§€çš„å¼€å‘ä½“éªŒ                                 |
| **Socket.io**       | æˆç†Ÿçš„ WebSocket åº“ï¼Œè‡ªåŠ¨é‡è¿ï¼Œæˆ¿é—´æ”¯æŒ                        |
| **shadcn/ui**       | åŸºäº Radix + Tailwindï¼Œå¯å¤åˆ¶ä»£ç ï¼Œå®Œå…¨å¯æ§ï¼Œæ— ä¾èµ–é”å®š        |
| **Gluestack UI v3** | ç±»ä¼¼ shadcn/ui çš„ copy-paste æ¨¡å¼ï¼ŒåŸºäº NativeWindï¼Œè·¨å¹³å°ä¸€è‡´ |
| **libsignal**       | Signal å®˜æ–¹åŠ å¯†åº“ï¼Œç»è¿‡éªŒè¯çš„ç«¯åˆ°ç«¯åŠ å¯†å®ç°                    |

### B. å‚è€ƒèµ„æº

- [Turborepo æ–‡æ¡£](https://turbo.build/repo/docs)
- [pnpm Workspace](https://pnpm.io/workspaces)
- [Electron Vite](https://electron-vite.org/)
- [React Native Monorepo](https://reactnative.dev/docs/environment-setup)
- [Nest.js æ–‡æ¡£](https://docs.nestjs.com/)
- [Signal Protocol](https://signal.org/docs/)
- [shadcn/ui æ–‡æ¡£](https://ui.shadcn.com/)
- [Gluestack UI æ–‡æ¡£](https://gluestack.io/)
- [Prometheus ç›‘æ§](https://prometheus.io/docs/)
- [Sentry é”™è¯¯è¿½è¸ª](https://docs.sentry.io/)

---

_æ–‡æ¡£ç‰ˆæœ¬: 2.1.0_
_æœ€åæ›´æ–°: 2025-12-04_
